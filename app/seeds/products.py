from app.models import (db, Product)
import requests
import json

listIds = [869089671, 1010544161, 790548510, 838850663, 958470432, 968614635, 660656390, 960025816, 881950236, 656717168, 660466518, 869089671, 717585690, 704055677, 893487323, 879515562, 851954236, 825219664, 825951020, 889714076, 743110697, 124069423, 973088979, 206596327, 938257202, 680296464, 537326756, 789911513, 776994638, 874011247, 996569662, 1010543893, 769190887, 1007911171, 556299059, 926686272, 192937836, 983036585, 856400282, 929039215, 771189500, 996576342, 624193328, 756460714, 953586708, 791530087, 971526858, 775410536, 673352111, 996576326, 697472878, 988855081, 711045890, 942519907, 919732170, 981931975, 934768517, 1010543973, 666778382, 835117178, 1010336673, 922865541, 791087395, 560111235, 974208776, 972450118, 831564833, 962382791, 279547712, 762431594, 871006931, 869293565, 999389829, 923264662, 690717659, 961550058, 620476968, 898057543, 940508172, 931360218, 615988076, 184548131, 631852457, 758176763, 878759725, 921587427, 807146594, 1000457579, 887196749, 804933537, 593959660, 827542561, 1010543871, 909260051, 671625302, 764241492, 678803780, 986611906, 840484560, 994540040, 690717659]


def seed_products():
    i = 1
    while i < len(listIds) -1:
        response = requests.get(f'https://openapi.etsy.com/v2/listings/{listIds[i]}/?api_key=9i7i1vu4xhs80233snqp1t4y')
        data = response.json()
        listings = data['results']
        for item in listings:
            demo = Product(
                name=item["title"],
                store_id=(i/20)+1,
                price=item["price"],
                quantity=item["quantity"],
                description=item["description"],
            )
            db.session.add(demo)
        i += 1
    db.session.commit()

def undo_products():
    db.session.execute('TRUNCATE products RESTART IDENTITY CASCADE;')
    db.session.commit()
