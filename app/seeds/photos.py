from faker import Faker
from app.models import (db, Photo)
import random
import requests
import json
from ..config import Config
import os
from dotenv import load_dotenv
load_dotenv()


API_KEY = os.getenv('API_SECRET_KEY')

faker = Faker()
listIds = [993025577,  993025577,  774020657, 1016114134, 906423221, 1008530478, 968000208, 958908633, 923180202, 971998495, 1001382844, 970509998, 995316543, 1029556599, 1030082275, 720635906, 1012899660, 715863884, 1000175299, 1000737822, 1002898290, 974343023, 985821126, 923666278, 1010989109, 994319679, 725568588, 1030082243, 951208984, 250182852, 940181622, 385994144, 1016109336, 547247768, 741888359, 620758431, 710991395, 1012579310, 812380896, 721626050, 612240763, 1022933915, 1030082221, 955960735, 713125785, 1000724596, 665074116, 1016113936, 1016113942, 814718511, 166133183, 780872759, 1000702195, 280817328, 1015259145, 241384863, 553819998, 897012805, 1016113928, 499787818, 670365214, 606418149, 528697492, 956001624, 612633858, 595770030, 266981158, 985531678, 904744076, 924035269, 751888209, 782644342, 977702443, 829525769, 1030082155, 385764938, 1016113892, 1016182873, 776073801, 199409352, 829445684, 777394725, 869047612, 1016113884, 861957615, 756337881, 632470633, 926037972, 877860325, 982652036, 907039579, 813510025, 733047720, 696837026, 1016113868, 884226536, 944105640, 812482463, 958458970, 792122793, 884915584,  884915584]

def seed_photos():
    i = 1
    while i < len(listIds) - 1:
        response = requests.get(
            f'https://openapi.etsy.com/v2/listings/{listIds[i]}/images/?api_key=9i7i1vu4xhs80233snqp1t4y').json()

        photosObj = response['results']
        for photo in photosObj:
            demo = Photo(
                product_id=i,
                photo_url=photo["url_fullxfull"]
            )
            db.session.add(demo)
        i += 1
    db.session.commit()


def undo_photos():
    db.session.execute('''TRUNCATE photos RESTART IDENTITY CASCADE;''')
    db.session.commit()
