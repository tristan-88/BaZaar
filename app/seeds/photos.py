from faker import Faker
from app.models import (db, Photo)
import random
import requests
import json
from ..config import Config
import os
from dotenv import load_dotenv
load_dotenv()


API_KEY = os.getenv('API_SECRET_KEY')

faker = Faker()

listIds = [1036360345, 911799896, 942124265, 516067855, 850724773, 875164556, 887673503, 704471897, 1035358521, 487241279, 863411968, 970522683, 1022401946, 979636018, 1035991167, 883464743, 788992654, 1028192245, 618118433, 811043936, 174073830, 913809419, 820261496, 935403093, 745416314, 944197200, 843763462, 839543269, 617804042, 1022401858, 928955720, 529513667, 1016144138, 620143000, 609620323, 285700335, 933208785, 1036356161, 251826196, 774740889, 118921521, 1003017788, 994790397, 818387348, 1036360149, 964731137, 827725099, 724340748, 1036355831, 1022528711, 1003710144, 1022401802, 627404614, 1036360113, 708112936, 260654269, 923915234, 925611949, 1036358401, 992251803, 703333986, 1036356719, 1033813023, 711617555, 847016643, 1015775022, 865356186, 882615453, 793196015, 681290508, 833284349, 865300717, 1004736183, 812561237, 936040647, 804143373, 774109617, 711126559, 722049377, 630831528, 1022401754, 846633639, 861403991, 1022393618, 897855569, 1022401744, 846166615, 1022401740, 839960048, 818404104, 1036360015, 911495713, 1031921307, 652782995, 926940958, 984327386, 1036360003, 483751535, 751713092, 1014809912]

def seed_photos():
    i = 1
    while i < len(listIds) - 1:
        response = requests.get(
            f'https://openapi.etsy.com/v2/listings/{listIds[i]}/images/?api_key=9i7i1vu4xhs80233snqp1t4y').json()

        photosObj = response['results']
        for photo in photosObj:
            demo = Photo(
                product_id=i,
                photo_url=photo["url_fullxfull"]
            )
            db.session.add(demo)
        i += 1
    db.session.commit()


def undo_photos():
    db.session.execute('''TRUNCATE photos RESTART IDENTITY CASCADE;''')
    db.session.commit()
