from faker import Faker
from app.models import (db, Photo)
import random
import requests
import json
from ..config import Config
import os
from dotenv import load_dotenv
load_dotenv()


API_KEY = os.getenv('API_SECRET_KEY')

faker = Faker()
listIds = [493750467,  957784795, 957784795, 1018585203, 1018585193, 818438030, 753715597, 1004608438, 813500632, 998063405, 933631047, 951589547, 1007893325, 1010892701, 957548195, 965073159, 1004608388, 873906515, 921661856, 708136523, 1018585079, 784264358, 780554812, 809382552, 1018585063, 876897379, 592774290, 495578359, 812992421, 826177387, 805291295, 921856259, 239999893, 240195606, 893910353, 877645316, 253145344, 838301267, 941379638, 854420032, 1018584997, 656128221, 801628807, 920060146, 202807560, 85369397, 287426439, 937697100, 986361971,
           85822257, 664563544, 1000071982, 992374763, 266846712, 1018584981, 607087134, 908172219, 588611160, 810638220, 248716823, 920532803, 728529048, 798950653, 1004608184, 1018578673, 266142510, 1018584915, 760416178, 581233342, 905515090, 254700563, 921324562, 704270129, 768315755, 947086569, 639950825, 855187625, 752023309, 989263412, 832492544, 798812421, 958854442, 1018584863, 1004608106, 534559235, 749868186, 749147673, 1004608090, 923538774, 895105921, 758165578, 111142278, 1004608092, 941046967, 733955128, 737880470, 1004608074, 1018583849,  1018583849, 687072741]


def seed_photos():
    i = 1
    while i < len(listIds) - 1:
        response = requests.get(
            f'https://openapi.etsy.com/v2/listings/{listIds[i]}/images/?api_key=9i7i1vu4xhs80233snqp1t4y').json()

        photosObj = response['results']
        for photo in photosObj:
            demo = Photo(
                product_id=i,
                photo_url=photo["url_fullxfull"]
            )
            db.session.add(demo)
        i += 1
    db.session.commit()


def undo_photos():
    db.session.execute('''TRUNCATE photos RESTART IDENTITY CASCADE;''')
    db.session.commit()
