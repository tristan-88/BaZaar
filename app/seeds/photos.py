from faker import Faker
from app.models import (db, Photo)
import random
import requests
import json
from ..config import Config
import os
from dotenv import load_dotenv
load_dotenv()


API_KEY = os.getenv('API_SECRET_KEY')

faker = Faker()
listIds = [1013675723, 1013675723, 833203529, 1013675649, 677016032, 264334553, 848002131, 718268207, 723038309, 848002023, 915837748, 934027289, 738253991, 932033410, 888973612, 652393518, 932965101, 999705164, 236395303, 1013673937, 1009778343, 961460143, 1013675583, 1013675571, 1013675563, 640675897, 591548336, 976084196, 999705142, 1013672521, 982820944, 939672964, 732922285, 826844573, 940825663, 1010120195, 824009227, 982515753, 864032146, 979592892, 939237496, 545036630, 695605203, 725492156, 231769192, 472942305, 1013675525, 930166644, 826317893, 966665734, 981914446, 680982679, 999705090, 980987254, 986423978, 1006367787, 975174398, 769523143, 938021412, 765406246, 999705048, 999705046, 958128027, 655254574, 985499651, 743020933, 752013500, 251173998, 944251939, 963073859, 752010324, 826390244, 1013675415, 701994352, 664763821, 742309055, 719741968, 622434382, 1013675399, 556378882, 913090451, 480161040, 951952717, 951305623, 771345830, 993800902, 737387938, 978324045, 743701868, 930209579, 895831893, 177270963, 780827903, 980429190, 842854014, 923462501, 651062190, 962572520, 847694810, 898400973, 1013675367,1013675367]

def seed_photos():
    i = 1
    while i < len(listIds) -1:
        response = requests.get(f'https://openapi.etsy.com/v2/listings/{listIds[i]}/images/?api_key={API_KEY}').json()
        photosObj = response['results']
        for photo in photosObj:
            demo = Photo(
                product_id=i,
                photo_url=photo["url_fullxfull"]
            )
            db.session.add(demo)
        i += 1
    db.session.commit()


def undo_photos():
    db.session.execute('''TRUNCATE photos RESTART IDENTITY CASCADE;''')
    db.session.commit()